response <- c(0,1,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0)
fixed1 <- c(104,149,120,93,90,54,68,29,74,86,71,83,39,95,89,122,41,188,142,63,129,59,90,132,164,91,87,76,62,68,76,102,96,91,92,91,101,108,85,79,95,66,63,87,54,87,92,93,126,118,76,102,43,96,94,159,79,88,68,66,105,139,83,10,84,149,94,133,117,105,92,106,85,77,56,17,132,94,138,35,111,81,91,102,53,130,77,115,93,58,42,101,91,86,126,59,166,116,136,157,74,92,99,145,89,77,106,84)
fixed2 <- c(24.07,24.07,24.07,24.07,23.63,22.47,22.47,23.9,23.9,23.14,23.69,23.35,23.35,23.35,23.35,23.35,22.85,22.17,22.17,23.18,23.18,23.18,22.17,23.3,23.3,23.3,23.91,23.91,23.46,23.22,23.22,23.22,23.22,24.64,23.91,23.54,23.54,23.54,24.06,24.06,24.06,22.92,23.35,22.49,23.72,23.72,23.65,23.65,23.65,23.54,24.09,24.09,24.09,21.88,23.04,24.03,23.38,23.38,23.38,23.81,23.81,22.3,22.3,22.3,23.9,23.24,23.24,22.47,22.47,23.16,23.88,23.88,23.94,23.94,23.94,23.65,24.23,24.23,22.96,23.29,23.29,23.29,24.47,24.47,24.47,24.47,23.6,24.17,23.12,23.04,24.37,22.68,24.56,24.56,23.88,23.88,23,23,21.61,21.61,23.91,23.76,23.4,23.4,25.58,23.05,22.81,24.08)
fixed3 <- c(12,12,12,12,6,2,2,12,12,13,4,11,11,11,11,11,13,15,15,17,7,15,15,8,8,8,6,6,2,11,11,11,11,15,18,17,17,17,13,13,13,10,12,18,10,10,3,3,3,4,18,18,18,7,10,12,18,18,18,6,6,4,4,6,7,17,9,16,4,9,2,4,11,4,4,6,16,13,17,12,12,12,12,12,12,12,5,15,16,12,12,11,6,6,13,13,2,2,15,8,15,2,13,13,5,2,11,12)
fixed4 <- c(3,3,6,5,2,2,5,2,4,4,5,2,2,3,3,6,6,2,4,2,3,2,2,2,2,2,4,7,3,4,5,4,3,2,2,2,4,2,5,4,2,2,3,2,2,2,4,6,4,9,2,2,2,4,3,5,3,4,5,2,3,2,2,2,2,4,3,4,2,3,2,4,5,4,6,6,2,4,4,2,3,6,2,3,5,4,4,3,2,2,2,3,3,2,2,4,5,2,4,2,2,2,7,4,3,2,7,4)
random1 <- as.character(quote(c(A,B,C,D,A,A,B,B,A,A,A,A,B,C,D,E,B,A,B,C,D,A,B,C,A,B,A,C,C,A,B,C,D,A,A,A,B,C,A,B,C,B,B,A,B,C,A,B,D,B,B,C,E,C,C,A,B,C,D,B,C,A,C,D,B,B,C,C,E,C,C,B,B,C,D,B,C,D,B,B,C,D,B,C,D,E,B,E,D,B,C,C,C,D,D,E,C,D,C,D,D,D,C,D,C,C,D,E)))[-1]
random2 <- as.character(quote(c(st110,st110,st110,st110,st207,st205,st205,st113,st113,st112,st115,st125,st125,st125,st125,st125,st111,st107,st107,st101a,st114,st101,st102,st104,st104,st104,st206,st206,st209,st119,st119,st119,st119,st124,st120,st118,st118,st118,st123,st123,st123,st116,st112a,st108,st106,st106,st208,st208,st208,st115,st108,st108,st108,st114,st103,st204,st120,st120,st120,st105,st105a,st210,st210,st207,st122,st118,st203,st119a,st115,st203,st209b,st210,st119,st119b,st119b,st219,st121,st123,st118,st101b,st101b,st101b,st109b,st109b,st109b,st109b,st127,st117,st121,st203b,st204,st125,st105b,st105b,st112,st112,st205,st214,st102,st104,st107,st221,st111,st111,st127,st225,st109a,st203b)))[-1]
random3 <- as.character(quote(c(M34101,M34101,M34101,M34101,M34117,M34120,M34120,M34128,M34128,M34133,M34135,M34136,M34136,M34136,M34136,M34136,M34140,M34141,M34141,M34155,M34155,M34155,M34157,M34162,M34162,M34162,M34172,M34172,M34176,M34178,M34178,M34178,M34178,M34182,M34183,M34185,M34185,M34185,M34186,M34186,M34186,M34189,M36501,M36504,M36510,M36510,M36514,M36514,M36514,M36519,M36521,M36521,M36521,M36524,M36541,M36569,M36572,M36572,M36572,M36584,M36584,M36590,M36590,M36590,M36592,M36616,M36616,M36618,M36618,M36628,M36636,M36636,M36646,M36646,M36646,M36653,M36659,M36659,M36664,M36667,M36667,M36667,M36668,M36668,M36668,M36668,M36669,M36684,M36685,M36741,M36757,M36771,M36797,M36797,M36822,M36822,M36833,M36833,M36845,M36845,M36856,M36892,M49816,M49816,M65102,M65105,M65128,M65135)))[-1]

library(lme4)
library(optimx)
glmm1 <- glmer(response ~ scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
               + (1|random1) + (1|random2) + (1|random3), family="binomial")
glmm2 <- glmer(response ~ scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
               + (1|random1) + (1|random2) + (1|random3),
               family="binomial", control = glmerControl(optimizer ="Nelder_Mead"))
glmm3 <- glmer(response ~ scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
               + (1|random1) + (1|random2) + (1|random3),
               family="binomial", control = glmerControl(
                 optimizer ='optimx', optCtrl=list(method='L-BFGS-B')))

hasConverged(glmm3)

myTryCatch(glmm1)
results2[2,2]<-tryc(unlist(myTryCatch2(glmm1<-glmer(response ~ scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
                 + (1|random1) + (1|random2) + (1|random3), family="binomial"))$warning$message))

hey<-glmm1<-glmer(response ~ scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
                  + (1|random1) + (1|random2) + (1|random3), family="binomial")
results2[2,1]<-
  unlist(
   hoho<-myTryCatch(hey<-glmer(response ~
                       scale(fixed1) + scale(fixed2) + scale(fixed3) + scale(fixed4)
                       + (1|random1) + (1|random2) + (1|random3), family="binomial"))
    [["message"]])[1]

results2[5,1]<-unlist(hi[["message"]][1])
write.csv(results2,"model_results/results2_test.csv")
